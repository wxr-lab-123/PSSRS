# 医院自助挂号注册系统（PSSRS1）需求说明书

## 1. 项目概述

- **项目名称**：医院自助挂号注册系统（PSSRS1）  
- **项目目标**：为医院提供一套覆盖患者自助挂号、就诊信息查询、线上支付、排队叫号等功能的一体化自助服务系统，减少窗口排队压力，提高患者就医体验和医院运营效率。  
- **主要角色**：  
  - **患者/就诊人**（含家属代挂）  
  - **医院工作人员**（导诊台/收费处/窗口）  
  - **管理员**（信息科/运维人员）  

---

## 2. 系统构成

- **后端**：Spring Boot 服务端（server 模块），提供统一 REST API  
- **共享模块**：common 模块（工具类、通用配置、异常处理等）  
- **实体模块**：pojo 模块（实体类、DTO、VO 等）  
- **前端 1**：管理后台（Vue 技术栈）  
- **前端 2**：微信小程序（患者端）

---

## 3. 功能需求

### 3.1 患者端（微信小程序）

1. **账号注册与登录**
   - 支持微信一键授权登录（获取 openid、头像、昵称）。
   - 支持绑定手机号码（短信验证码或微信手机号授权）。
   - 支持绑定多个就诊人（本人及家属），可设置“默认就诊人”。

2. **个人信息与就诊人管理**
   - 查看和编辑个人基础信息（姓名、性别、手机号、身份证号等）。
   - 管理就诊人列表：新增/编辑/删除。
   - 为就诊人维护基础信息（证件号、与本人关系等）。

3. **科室与医生查询**
   - 按医院科室分类展示（内科、外科、儿科、妇产科等）。
   - 查看科室简介、楼层位置、出诊时间。
   - 查询医生列表：姓名、职称、专长、出诊时间、剩余号源量。

4. **挂号/预约挂号**
   - 选择科室 → 选择医生 → 选择就诊日期与时段 → 获取可用号源。
   - 实时展示剩余号源数量，防止超挂。
   - 支持普通号、专家号等号种。
   - 提交挂号信息：就诊人、科室、医生、时间段、费别（医保/自费等）。

5. **费用支付**
   - 支持微信支付（JSAPI、小程序支付）。
   - 展示挂号费用明细（挂号费、诊疗费等）。
   - 支付成功后生成电子挂号凭证与订单记录。

6. **挂号记录与退号**
   - 查看历史挂号记录（支持按时间、科室、医生筛选）。
   - 展示挂号详情：就诊人、科室、医生、就诊时间、订单状态、支付金额。
   - 在医院规定时间内支持线上退号：
     - 退号规则（如就诊前 X 小时内不可退号）。
     - 成功退号后自动发起退款（原路退回微信）。

7. **排队叫号与就诊进度**
   - 展示当前就诊排队信息（当前叫号、前面等待人数、预计等待时间等）。
   - 实时刷新或轮询接口获取最新叫号数据。
   - 支持消息提醒（如使用订阅消息：即将就诊提醒、过号提醒等）。

8. **就诊记录与报告查询（如有）**
   - 查询历史就诊记录列表。
   - 查看门诊记录简要信息。
   - 预留检验/检查报告结果查询入口（接口对接后可扩展）。

9. **系统设置与帮助**
   - 常见问题 FAQ、使用指南。
   - 客服电话、医院地图/导航链接。
   - 用户协议与隐私政策展示。

---

### 3.2 管理后台（Vue 管理端）

1. **用户/就诊人管理**
   - 查询患者账号列表（按手机号/姓名/证件号等）。
   - 查看就诊人绑定情况。
   - 可对异常账号进行禁用/解禁（须审慎设计权限）。

2. **科室与医生管理**
   - 维护医院科室信息（名称、编号、楼层、简介、排序等）。
   - 维护医生信息（姓名、职称、所属科室、简介、状态等）。
   - 维护医生排班（日期、出诊时段、每日号源量、号种等）。

3. **号源与挂号管理**
   - 查看每日号源使用情况统计（按科室/医生）。
   - 查询挂号订单列表（支持多条件筛选和导出）。
   - 可手动调整 / 添加 / 取消某些挂号记录（记录操作日志）。

4. **支付与退款管理**
   - 查看支付订单记录及状态（已支付、待支付、已退款等）。
   - 对异常订单执行人工退款处理（结合财务流程）。
   - 导出对账报表（按时间段、科室、医生等维度）。

5. **排队叫号管理**
   - 查看实时排队情况。
   - 支持人工叫号、过号标记、插队处理（若与线下系统对接需统一）。

6. **统计报表**
   - 日/周/月挂号量统计。
   - 科室/医生就诊量统计。
   - 线上支付金额统计。

7. **系统配置与权限管理**
   - 挂号时间规则配置（最早/最晚可预约时间、退号截止时间等）。
   - 号种/费用规则配置。
   - 管理员账号与角色权限配置（RBAC）。

---

## 4. 非功能需求

1. **性能**
   - 单医院并发挂号高峰期系统需保持稳定：支持同时在线用户数量及 QPS 需根据医院规模预留冗余。
   - 常见查询接口响应时间控制在 1–2 秒内（正常网络条件）。

2. **安全**
   - 采用 HTTPS 加密传输。
   - 严格保护患者隐私信息，敏感信息加密存储。
   - 登录态管理：Token/JWT，有效期与刷新策略。
   - 关键操作（退号、退款等）需权限校验与操作日志。

3. **可靠性与可用性**
   - 保障核心挂号、支付流程高可用。
   - 异常情况友好提示（如号源耗尽、支付失败、网络异常等）。
   - 支持基本的容错和重试机制，避免重复扣费与重复挂号。

4. **可维护性**
   - 后端模块化设计（server/common/pojo 分层清晰）。
   - 接口文档（Swagger/Knife4j 等）自动生成，便于前后端联调。
   - 日志与监控完善，便于问题追踪和运维监控。

5. **兼容性**
   - 微信小程序兼容主流机型与系统版本。
   - 管理后台适配主流浏览器（Chrome、Edge 等）。

---

## 5. 接口与数据（概要）

> 具体字段和数据结构可结合实际数据库设计与 `pojo` 模块最终细化。

- **用户与就诊人接口**：注册登录、绑定手机号、就诊人增删改查。
- **科室/医生接口**：科室列表、医生列表、排班查询。
- **挂号接口**：号源查询、创建挂号订单、查询挂号记录、退号。
- **支付接口**：统一下单、支付回调、退款、对账。
- **排队接口**：获取排队信息、叫号进度查询。
- **后台管理接口**：用户管理、科室/医生/排班管理、订单管理、统计报表等。

---

## 6. 实施与交付

- **阶段划分（示例）**  
  - **第一阶段**：基础挂号流程（注册登录、科室医生查询、挂号、支付、挂号记录）。  
  - **第二阶段**：排队叫号、退号退款、统计报表。  
  - **第三阶段**：对接院内 HIS/检验检查系统、报告查询、消息通知优化等。  

- **交付物**
  - 源代码（后端 + 管理端 + 小程序端）。  
  - 部署文档与运维说明。  
  - 接口文档与数据库设计文档。  
  - 用户操作手册（患者端与后台管理员端）。
